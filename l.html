<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Auto Location Save</title>
</head>
<body>

<h2>Location is being captured automatically...</h2>
<p id="status">Waiting for permission...</p>

<script type="module">
  // üîπ Firebase imports
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
  import { getDatabase, ref, push } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";

  // üîπ Your Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyB97P3HgOUUhTTfDyqZ8_hbp3cQbp3R1Rc",
    authDomain: "chat-a9021.firebaseapp.com",
    databaseURL: "https://chat-a9021-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "chat-a9021",
    storageBucket: "chat-a9021.firebasestorage.app",
    messagingSenderId: "910705138024",
    appId: "1:910705138024:web:8bbf2dd7840b6e28015edd"
  };

  // üîπ Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  const statusEl = document.getElementById("status");

  // üîπ Auto-run on page load
  window.onload = () => {
    if (!navigator.geolocation) {
      statusEl.innerText = "Geolocation not supported ‚ùå";
      return;
    }

    navigator.geolocation.getCurrentPosition(
      (position) => {
        const locationData = {
          latitude: position.coords.latitude,
          longitude: position.coords.longitude,
          accuracy: position.coords.accuracy,
          timestamp: new Date().toISOString(),
          userAgent: navigator.userAgent
        };

        // üîπ Save to Firebase
        push(ref(db, "user_locations"), locationData)
          .then(() => {
            statusEl.innerHTML = `
              Location saved ‚úÖ <br>
              Lat: ${locationData.latitude} <br>
              Long: ${locationData.longitude}
            `;
          })
          .catch((err) => {
            statusEl.innerText = "Firebase error ‚ùå";
            console.error(err);
          });
      },
      (error) => {
        statusEl.innerText = "Permission denied or error ‚ùå";
        console.error(error.message);
      },
      {
        enableHighAccuracy: true,
        timeout: 10000
      }
    );
  };
</script>

</body>
</html>

